<html>
<head>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script type="text/javascript" src="sample.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<h1>Greasy App</h1>
	<p>Hi {{firstName}}.</p>
	<h2>Attendance</h2>
	<p>Right now you have a {{score}} in Glee Club.</p>
	<svg></svg>
</body>
<script type="text/javascript">
	var svg = d3.select("svg");
	var margin = {
		"top":20,
		"right":20,
		"bottom":20,
		"left":20
	};
	var width = window.innerWidth - margin.left - margin.right;
	var height = window.innerHeight - margin.top - margin.bottom;
	svg.attr("width", width)
		.attr("height", height);

	var parseTime = d3.timeParse("%d-%b-%y");
	sampleData.attendance.forEach(function (d){
		d.date = new Date(d.date*1000);
		// d.date = parseTime(d.date);
		// console.log("date", d.date);
	});

	var x = d3.scaleTime()
		.rangeRound([margin.left, width-margin.right]);
	var y = d3.scaleLinear()
		.rangeRound([height-margin.bottom, margin.top]);
	x.domain(d3.extent(sampleData.attendance, function(d) { return d.date; }));
	y.domain([0, 100]);
	// console.log("y", y(50));
	// console.log("date", sampleData.attendance[10].date);
	// console.log("x", x(sampleData.attendance[10].date));

	var svgContainer = svg;
 
	var circles = svgContainer.selectAll("circle")
		.data(sampleData.attendance)
		.enter()
		.append("circle")
		.attr("cx", function (d) { return x(d.date); })
		.attr("cy", function (d) {
			if(d.partialScore > 0) return y(d.partialScore);
			else return y(0);
		})
		.attr("r", function (d) { return 5; })
		.attr("data-score", function (d) { return d.partialScore; })
		.style("fill", function(d) { return "blue"; });

	var valueline = d3.line()
	    .x(function(d) { return x(d.date); })
	    .y(function(d) { return y(d.partialScore); });
	svg.append("path")
      .data(sampleData.attendance)
      .attr("class", "line")
      .attr("d", valueline);

    svg.append("g")
      .attr("transform", "translate(0," + (height-margin.bottom) + ")")
      .call(d3.axisBottom(x));
    svg.append("g")
	    .attr("transform", "translate("+ margin.left +", 0)")
      .call(d3.axisLeft(y));



</script>
</html>